"use strict";const e=require("../../../common/vendor.js"),t=require("../../../utils/request.js"),s={__name:"CategoryManage",setup(s){const a=e.ref([]),n=e.reactive({name:"",status:1}),o=e.ref(-1),i=e.reactive({name:"",status:1}),c=async()=>{try{const s=await t.request({url:"https://bgnc.online/api/category/list",method:"GET"});200===s.code?(a.value=s.data,console.log("获取到的分类数据:",s.data)):e.index.showToast({title:s.message||"获取分类失败",icon:"none"})}catch(s){console.error("获取分类列表失败：",s),e.index.showToast({title:"获取分类列表失败",icon:"none"})}},l=async()=>{if(n.name)try{const s=await t.request({url:"https://bgnc.online/api/category",method:"POST",data:{name:n.name,status:n.status}});200===s.code?(e.index.showToast({title:"添加成功",icon:"success"}),n.name="",n.status=1,c()):e.index.showToast({title:s.message||"添加失败",icon:"none"})}catch(s){console.error("添加分类失败：",s),e.index.showToast({title:"添加分类失败",icon:"none"})}else e.index.showToast({title:"请输入分类名称",icon:"none"})},u=()=>{o.value=-1};return e.onMounted((()=>{c()})),(s,d)=>e.e({a:n.name,b:e.o((e=>n.name=e.detail.value)),c:1===n.status,d:e.o((e=>n.status=e.detail.value?1:0)),e:e.t(1===n.status?"启用":"禁用"),f:e.o(l),g:0===a.value.length},(a.value.length,{}),{h:e.f(a.value,((s,n,l)=>e.e({a:o.value!==n},o.value!==n?{b:e.t(s.name),c:e.t(1===s.status?"启用":"禁用"),d:e.n(1===s.status?"enabled":"disabled"),e:e.o((e=>(e=>{const t=a.value[e];i.name=t.name,i.status=t.status,o.value=e})(n)),s.id),f:e.o((a=>(async s=>{e.index.showModal({title:"确认删除",content:"确定要删除该分类吗？",success:async a=>{if(a.confirm)try{const a=await t.request({url:`https://bgnc.online/api/category/${s}`,method:"DELETE"});200===a.code?(e.index.showToast({title:"删除成功",icon:"success"}),c()):e.index.showToast({title:a.message||"删除失败",icon:"none"})}catch(n){console.error("删除分类失败：",n),e.index.showToast({title:"删除分类失败",icon:"none"})}}})})(s.id)),s.id)}:{g:i.name,h:e.o((e=>i.name=e.detail.value),s.id),i:1===i.status,j:e.o((e=>i.status=e.detail.value?1:0),s.id),k:e.t(1===i.status?"启用":"禁用"),l:e.o((a=>(async s=>{if(i.name)try{const a=await t.request({url:"https://bgnc.online/api/category",method:"PUT",data:{id:s,name:i.name,status:i.status}});200===a.code?(e.index.showToast({title:"更新成功",icon:"success"}),o.value=-1,c()):e.index.showToast({title:a.message||"更新失败",icon:"none"})}catch(a){console.error("更新分类失败：",a),e.index.showToast({title:"更新分类失败",icon:"none"})}else e.index.showToast({title:"请输入分类名称",icon:"none"})})(s.id)),s.id),m:e.o(u,s.id)},{n:s.id})))})}};wx.createComponent(s);
