"use strict";const e=require("../../common/vendor.js"),t=require("../../common/assets.js"),o=require("../../utils/request.js"),i={__name:"list",setup(i){const s=e.ref(""),a=e.ref([]),n=e.computed((()=>s.value?a.value.filter((e=>e.name.includes(s.value)||e.phone.includes(s.value))):a.value)),d=()=>{e.index.navigateTo({url:"/pages/address/edit"})};return e.onMounted((()=>{(async()=>{try{const t=await o.request({url:"https://bgnc.online/api/addressbook/list",method:"GET"});console.log("获取地址列表响应:",t),200===t.code||0===t.code?a.value=t.data||[]:e.index.showToast({title:t.msg||"获取地址失败",icon:"none"})}catch(t){console.error("获取地址列表失败：",t),e.index.showToast({title:"获取地址失败，请稍后再试",icon:"none"})}})()})),(i,l)=>e.e({a:s.value,b:e.o((e=>s.value=e.detail.value)),c:a.value.length>0},a.value.length>0?{d:e.f(n.value,((t,s,n)=>({a:e.t(t.name),b:e.t(t.phone),c:e.t(t.province),d:e.t(t.city),e:e.t(t.district),f:e.t(t.detail),g:e.o((o=>(t.id,void e.index.navigateTo({url:"/pages/address/edit"}))),t.id),h:e.o((e=>i.setDefaultAddress(t.id)),t.id),i:t.isDefault?1:"",j:e.o((i=>{return s=t.id,void e.index.showModal({title:"提示",content:"确定要删除该收货地址吗？",success:async t=>{if(t.confirm)try{const t=await o.request({url:`https://bgnc.online/api/addressbook/?id=${s}`,method:"DELETE",data:{id:s}});200===t.code?(a.value=a.value.filter((e=>e.id!==s)),e.index.showToast({title:"删除成功",icon:"success"})):e.index.showToast({title:t.msg||"删除失败",icon:"none"})}catch(i){e.index.showToast({title:"删除失败，请稍后再试",icon:"none"})}}});var s}),t.id),k:t.id})))}:{e:t._imports_0$4},{f:e.o(d)})}};wx.createPage(i);
